(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{383:function(t,s,a){"use strict";a.r(s);var e=a(42),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"å°æ˜çš„æ•…äº‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å°æ˜çš„æ•…äº‹"}},[t._v("#")]),t._v(" å°æ˜çš„æ•…äº‹")]),t._v(" "),a("p",[t._v("æŸå¤©å°æ˜æ­£åœ¨æµè§ˆBç«™ä¸»ç«™, ä¸ç»æ„é—´çœ‹åˆ°ä¸€æ¡å¹¿å‘Š: "),a("code",[t._v("10å…ƒå……å¹´è´¹å¤§ä¼šå‘˜")]),t._v(", 'è¿™å¯æ˜¯å¥½äº‹æƒ…å‘€', å°æ˜è¿™ä¹ˆæƒ³ç€å°±ç‚¹äº†è¿›å». ç»“æœåªçœ‹åˆ°äº†ä¸€ä¸ªç©ºç™½é¡µé¢... æ—¥å¸¸åæ§½å, å°æ˜ç»§ç»­éšä¾¿é€›ç€.")]),t._v(" "),a("p",[t._v("ç¬¬äºŒå¤©, å°æ˜åœ¨Bç«™ç›´æ’­çœ‹åˆ°ä¸€ä¸ªå¯çˆ±çš„èŒå¦¹å­, å°±æƒ³ä¸Šèˆ¹æ”¯æŒä¸€ä¸‹ğŸŒ¹, ç„¶åå°æ˜å°±å‘ç°è‡ªå·±èƒŒåŒ…å†…çš„'é‡‘ç“œå­'ä¸ç¿¼è€Œé£äº†...")]),t._v(" "),a("p",[t._v("å¯æ€œçš„å¦¹å­. ğŸ˜")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("tips: ä¸Šé¢çš„å†…å®¹çº¯å±æœæ’°, å°ç ´ç«™è¿™ä¹ˆä¼˜ç§€æ˜¯ä¸ä¼šæœ‰é—®é¢˜çš„")]),t._v(" "),a("hr"),t._v(" "),a("p",[a("strong",[t._v("å°æ˜çš„é‡‘ç“œå­æ˜¯å¦‚ä½•æ¶ˆå¤±çš„å‘¢?")])]),t._v(" "),a("p",[t._v("é—®é¢˜å‘ç”Ÿåœ¨å°æ˜æ‰“å¼€çš„ç©ºç™½é¡µé¢ä¸Š("),a("code",[t._v("10å…ƒå……å¹´è´¹å¤§ä¼šå‘˜")]),t._v("), æ”»å‡»è€…å°é»‘é€šè¿‡æµé‡åŠ«æŒå°†è¿™ä¸ªé¡µé¢æ³¨å…¥åˆ°å°æ˜è®¿é—®çš„ä¸»ç«™ä¸Š, åœ¨è¿™ä¸ªç©ºç™½é¡µé¢ä¸Šå‘ä¸»æ’­å°çº¢é€äº†ç¤¼ç‰©")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("https"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("send"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("gift"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("æˆ–")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("img")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://xx.xxx.com/send/gift"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("å› ä¸ºå°æ˜çš„ç”¨æˆ·ä¿¡æ¯åœ¨ç™»é™†ä¸»ç«™çš„æ—¶å€™è¢«ç§åˆ°äº†"),a("code",[t._v("cookie")]),t._v("ä¸­, è€Œ"),a("code",[t._v("cookie")]),t._v("ä¼šéšç€httpè‡ªåŠ¨å‘é€, æ‰€ä»¥ä¸Šé¢çš„è¯·æ±‚æˆåŠŸçš„å‘é€åˆ°äº†æœåŠ¡ç«¯, æœåŠ¡ç«¯ç»è¿‡éªŒè¯ç¡®å®šæ˜¯å°æ˜åœ¨å‘å°çº¢é€ç¤¼ç‰©, æ­£ç¡®æ•ˆåº”, å°±è¿™æ ·å°æ˜çš„é‡‘ç“œå­å°±æ¶ˆå¤±æ‰äº†")]),t._v(" "),a("p",[t._v("æ€»ç»“ä¸€ä¸‹å°±æ˜¯: å°é»‘å†’å……äº†å°æ˜ç»™å°çº¢é€äº†ç¤¼ç‰©")]),t._v(" "),a("h2",{attrs:{id:"csrf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csrf"}},[t._v("#")]),t._v(" CSRF")]),t._v(" "),a("p",[t._v("ä¸Šé¢å°æ˜çš„æ•…äº‹å°±æ˜¯ä¸€æ¬¡"),a("code",[t._v("CSRFæ”»å‡»")])]),t._v(" "),a("blockquote",[a("p",[t._v("cross-site request forgery è·¨ç«™è¯·æ±‚ä¼ªé€ , æ˜¯ä¸€ç§å†’å……ç”¨æˆ·å‘é€è¯·æ±‚çš„æ”»å‡»æ–¹å¼")])]),t._v(" "),a("h3",{attrs:{id:"csrfçš„æ”»å‡»æ€è·¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csrfçš„æ”»å‡»æ€è·¯"}},[t._v("#")]),t._v(" CSRFçš„æ”»å‡»æ€è·¯")]),t._v(" "),a("ol",[a("li",[t._v("å—å®³è€…è®¿é—®é¡µé¢A, æˆåŠŸç™»é™†, å¹¶ä¸”ç”¨æˆ·å‡­è¯æ˜¯ä¿å­˜åœ¨"),a("code",[t._v("cookie")]),t._v("ä¸­")]),t._v(" "),a("li",[t._v("å—å®³è€…å—æ”»å‡»è€…å¼•å¯¼è®¿é—®äº†æ”»å‡»è€…å‡†å¤‡å¥½çš„é¡µé¢B(A, Bä¸åŒæº)")]),t._v(" "),a("li",[t._v("æ”»å‡»è€…åœ¨é¡µé¢Bæäº¤äº†é¡µé¢Açš„æŸä¸ªè¯·æ±‚(A.com/xxx), ç”±äº"),a("code",[t._v("cookie")]),t._v("è‡ªåŠ¨å‘é€çš„å…³ç³», Açš„ç”¨æˆ·å‡­è¯è¢«å‘é€")]),t._v(" "),a("li",[t._v("æœåŠ¡ç«¯éªŒè¯Açš„ç”¨æˆ·å‡­è¯, ç¡®è®¤æ˜¯Aå‘é€è¿‡æ¥çš„è¯·æ±‚(å®é™…æ˜¯Bå‘é€çš„), æ­£ç¡®å“åº”")]),t._v(" "),a("li",[t._v("æ”»å‡»å®Œæˆ, A ğŸ˜¡")])]),t._v(" "),a("h3",{attrs:{id:"csrfçš„ç‰¹ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csrfçš„ç‰¹ç‚¹"}},[t._v("#")]),t._v(" CSRFçš„ç‰¹ç‚¹")]),t._v(" "),a("ul",[a("li",[t._v("è¯·æ±‚å‘é€è‡ªç¬¬ä¸‰æ–¹ç½‘ç«™")])]),t._v(" "),a("p",[t._v("ä¸€èˆ¬æ”»å‡»éƒ½æ˜¯æ¥è‡ªç¬¬ä¸‰æ–¹ç½‘ç«™, æ‰€ä»¥åƒç®€ä¹¦, çŸ¥ä¹...è®ºå›å¯¹äºè®¿é—®å¤–é“¾çš„urlä¼šè¿›è¡Œé£é™©æç¤º")]),t._v(" "),a("ul",[a("li",[t._v("é’ˆå¯¹cookieæ”»å‡»")])]),t._v(" "),a("p",[t._v("åˆ©ç”¨cookieè‡ªåŠ¨å‘é€ ä¸” åœ¨cookieä¸­ä¿å­˜ç”¨æˆ·ä¿¡æ¯æ¥è¾¾åˆ°å¯¹ç”¨æˆ·çš„å†’å……(è¿™é‡Œåªæ˜¯å†’å……ç”¨æˆ·, å¹¶ä¸èƒ½å¾—åˆ°cookieå†…å®¹)")]),t._v(" "),a("p",[t._v("å¦‚æœæŸç«™å°†ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åœ¨"),a("code",[t._v("localStorage")]),t._v("ä¸­, åˆ™å…¶ä¸ä¼šå­˜åœ¨CSRFæ”»å‡»çš„æ½œåœ¨é£é™©, è¿™æ˜¯å› ä¸ºå—åŒæºç­–ç•¥é™åˆ¶, åœ¨ç¬¬ä¸‰æ–¹é¡µé¢ä¸­(è¿™é‡Œæ’é™¤äº†çˆ¶å­åŸŸçš„æƒ…å†µ)æ— æ³•é€šè¿‡è„šæœ¬å¾—åˆ°ä¸»ç«™çš„å†…å®¹")]),t._v(" "),a("h3",{attrs:{id:"ä»€ä¹ˆæ ·çš„ç½‘ç«™å­˜åœ¨csrfé£é™©"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ ·çš„ç½‘ç«™å­˜åœ¨csrfé£é™©"}},[t._v("#")]),t._v(" ä»€ä¹ˆæ ·çš„ç½‘ç«™å­˜åœ¨CSRFé£é™©")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("ä½¿ç”¨"),a("code",[t._v("cookie")]),t._v("å­˜å‚¨ä¸€äº›å¯ä»¥é€šè¿‡æœåŠ¡ç«¯è¯·æ±‚çš„å¿…è¦ä¿¡æ¯(ç”¨æˆ·ä¿¡æ¯...)")])]),t._v(" "),a("li",[a("p",[t._v("å…·æœ‰çˆ¶/å­åŸŸåçš„ç½‘ç«™(e.g. image.baidu.com, zhidao.baidu.com)")])])]),t._v(" "),a("p",[t._v("è¿™æ˜¯ç”±"),a("code",[t._v("cookie")]),t._v("çš„åº”ç”¨åœºæ™¯å†³å®šçš„")]),t._v(" "),a("p",[t._v("ä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨"),a("code",[t._v("cookie")]),t._v("æ¥ä¿æŒä¼šè¯çŠ¶æ€, è¾¾åˆ°å…å¯†ç™»é™†çš„æ•ˆæœ")]),t._v(" "),a("p",[t._v("å¯¹äºå•ä¸€åŸŸåçš„ç½‘ç«™, ä½¿ç”¨"),a("code",[t._v("cookie")]),t._v("å…å¯†çš„å¥½å¤„åªæ˜¯åœ¨å‘é€è¯·æ±‚çš„æ—¶å€™å°‘äº›ä¸€äº›ä»£ç è€Œå·². å°†ä¸€äº›éœ€è¦æŒä¹…åŒ–çš„ä¿¡æ¯æ”¾åˆ°"),a("code",[t._v("localStorage")]),t._v("ä¸­, åŒæ ·å¯ä»¥åšåˆ°å…å¯†ç™»é™†")]),t._v(" "),a("p",[t._v("ä½†æ˜¯å¯¹äºçˆ¶/å­åŸŸåçš„ç½‘ç«™, ä½¿ç”¨"),a("code",[t._v("cookie")]),t._v("æ˜¯å¿…è¦çš„, ç”±äºåŒæºç­–ç•¥çš„é™åˆ¶, "),a("code",[t._v("a.xx.com")]),t._v("å’Œ"),a("code",[t._v("b.xx.com")]),t._v("çš„"),a("code",[t._v("localStorage")]),t._v("ä¸æ˜¯é€šç”¨çš„, ä½†æ˜¯é€šè¿‡é…ç½®"),a("code",[t._v("cookie")]),t._v("çš„"),a("code",[t._v("domain=xx.com")]),t._v(", "),a("code",[t._v("a.xx.com")]),t._v("å’Œ"),a("code",[t._v("b.xx.com")]),t._v("ä¼šå…±ç”¨ç›¸åŒçš„"),a("code",[t._v("cookie")])]),t._v(" "),a("p",[t._v("è¿™æ ·ä½¿ç”¨"),a("code",[t._v("cookie")]),t._v("å¯ä»¥å®ç°ä»"),a("code",[t._v("https://www.bilibili.com")]),t._v("è·³è½¬åˆ°"),a("code",[t._v("https://live.bilibili.com")]),t._v("ä¸‹ä¸éœ€è¦ç»§ç»­ç™»é™†, ä½¿ç”¨"),a("code",[t._v("localStorage")]),t._v("åˆ™ä¸èƒ½")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("tips: çˆ¶/å­åŸŸåä¸ä½¿ç”¨"),a("code",[t._v("cookie")]),t._v(", åœ¨æŠ€æœ¯ä¸Šä¹Ÿæ˜¯å¯ä»¥å®ç°è·³è½¬å…å¯†çš„, è¿™éœ€è¦ä½¿ç”¨ä¸€ä¸ªå¦å¤–çš„"),a("code",[t._v("c.xx.com")]),t._v(": ç”¨æ¥å­˜å‚¨ä¿¡æ¯, ç„¶ååˆ†åˆ«åœ¨"),a("code",[t._v("a.xx.com")]),t._v("å’Œ"),a("code",[t._v("b.xx.com")]),t._v("å†…åµŒå…¥è¿™æ ·"),a("code",[t._v("iframe")])]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("iframe")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("c.xx.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"csrfçš„é˜²å¾¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csrfçš„é˜²å¾¡"}},[t._v("#")]),t._v(" CSRFçš„é˜²å¾¡")]),t._v(" "),a("p",[t._v("æ ¹æ®"),a("a",{attrs:{href:"#csrf%E7%9A%84%E7%89%B9%E7%82%B9"}},[t._v("CSRFçš„ç‰¹ç‚¹")]),t._v("æˆ‘ä»¬å¯ä»¥ä»ä»¥ä¸‹3ä¸ªæ–¹é¢å¯¹CSRFè¿›è¡Œé˜²å¾¡")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("æ”»å‡»å‘ç”Ÿè‡ªç¬¬ä¸‰æ–¹ç½‘ç«™, æ¥å£è¦åˆ¤æ–­æ˜¯å¦åŒæº(åœ¨å¯å‘é€è¯·æ±‚çš„ç™½åå•å†…)")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("è¯·æ±‚é™„åŠ é¢å¤–çš„ä¿¡æ¯(è¿™ä¸ªé¢å¤–çš„ä¿¡æ¯è¦åœ¨æœ¬ç«™å†…é€šè¿‡è„šæœ¬å¾—åˆ°)")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("ä¸ä½¿ç”¨cookie")])])])]),t._v(" "),a("h4",{attrs:{id:"æ”»å‡»å‘ç”Ÿè‡ªç¬¬ä¸‰æ–¹ç½‘ç«™-æ¥å£è¦åˆ¤æ–­æ˜¯å¦åŒæº-åœ¨å¯å‘é€è¯·æ±‚çš„ç™½åå•å†…"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ”»å‡»å‘ç”Ÿè‡ªç¬¬ä¸‰æ–¹ç½‘ç«™-æ¥å£è¦åˆ¤æ–­æ˜¯å¦åŒæº-åœ¨å¯å‘é€è¯·æ±‚çš„ç™½åå•å†…"}},[t._v("#")]),t._v(" æ”»å‡»å‘ç”Ÿè‡ªç¬¬ä¸‰æ–¹ç½‘ç«™, æ¥å£è¦åˆ¤æ–­æ˜¯å¦åŒæº(åœ¨å¯å‘é€è¯·æ±‚çš„ç™½åå•å†…)")]),t._v(" "),a("p",[t._v("è¿™ç§é˜²å¾¡æ–¹å¼æ˜¯æ ¹æ®ç”¨æˆ·ä»£ç†(æµè§ˆå™¨)åœ¨è®¿é—®ç¬¬ä¸‰æ–¹é“¾æ¥ä¼šåœ¨"),a("code",[t._v("request headers")]),t._v("å†…æ·»åŠ ä¸€äº›é¢å¤–å­—æ®µ")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("referer")])]),t._v(" "),a("li",[a("p",[t._v("origin")])])]),t._v(" "),a("p",[t._v("ç”¨æˆ·ä»£ç†åœ¨"),a("code",[t._v("<a />")]),t._v(", "),a("code",[t._v("<iframe />")]),t._v(", "),a("code",[t._v("<img />")]),t._v(", "),a("code",[t._v("è·¨åŸŸxhr")]),t._v("...æ—¶, å¦‚æœæºåœ°å€æ˜¯ä¸æ˜¯å½“å‰ä¸»ç«™çš„åœ°å€, åˆ™ä¼šå¢åŠ ä¸€ä¸ª"),a("code",[t._v("referer: ä¸»ç«™åœ°å€")])]),t._v(" "),a("p",[t._v("å¯¹äº"),a("code",[t._v("CORS")]),t._v("è¯·æ±‚("),a("code",[t._v("<img />")]),t._v(", "),a("code",[t._v("è·¨åŸŸxhr")]),t._v("), é™¤äº†refererè¿˜ä¼šå¢åŠ ä¸€ä¸ª"),a("code",[t._v("origin: window.location.origin")]),t._v(", ç”¨æ¥åš"),a("code",[t._v("CORS")]),t._v("éªŒè¯")]),t._v(" "),a("p",[t._v("å°†"),a("strong",[t._v("referer")]),t._v("å’Œ"),a("strong",[t._v("origin")]),t._v("ä½œä¸ºåˆ¤æ–­æ˜¯å¦æ˜¯CSRFæ”»å‡»çš„ä¾æ®, å¦‚æœå­˜åœ¨refereræˆ–origin ä¸” refereræˆ–originä¸åœ¨ç™½åå•å†…åˆ™è®¤ä¸ºæ˜¯æ”»å‡», æ‹’ç»è¯·æ±‚ âŒ")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("è¿™ç§è¯·æ±‚æ˜¯å¦æ¥è‡ªç¬¬ä¸‰æ–¹ç½‘ç«™çš„åˆ¤æ–­ä¾èµ–äºç”¨æˆ·ä»£ç†, åŒæ—¶ç”¨æˆ·ä»£ç†æä¾›äº†"),a("code",[t._v("Referrer-Policy: <value>")]),t._v("æ¥æ§åˆ¶refererçš„è¡¨ç°è¡Œä¸º")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("referrer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("no-referrer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("è¿™æ ·ç”¨æˆ·ä»£ç†å°±ä¸ä¼šæ·»åŠ refererè¯·æ±‚å¤´å­—æ®µ, å¯èƒ½ä½ ä¼šè¯´: 'ä¸æ˜¯è¿˜æœ‰originä¹ˆ, è¿™ä¸ªå­—æ®µä¸ä¼šæ¶ˆå¤±, å¯¹refererå’Œoriginåšä¸é€»è¾‘ä¸å°±å¥½äº†'")]),t._v(" "),a("p",[t._v("ä½†æ˜¯"),a("strong",[t._v("origin")]),t._v("åªä¼šè¢«æ·»åŠ åœ¨"),a("code",[t._v("è·¨åŸŸxhr")]),t._v(", "),a("code",[t._v("<img />")]),t._v("ä¸­, å¯¹äºGETè¯·æ±‚, æ”»å‡»è€…å¯ä»¥é€šè¿‡"),a("code",[t._v("<a />")]),t._v("è¯±å¯¼ç‚¹å‡»å’Œ"),a("code",[t._v("<script />")]),t._v("çš„æ–¹å¼")]),t._v(" "),a("p",[t._v("è¿™ç§æƒ…å†µä¸‹"),a("strong",[t._v("referer")]),t._v("å’Œ"),a("strong",[t._v("origin")]),t._v("éƒ½ä¸å­˜åœ¨, ä¼šè¢«è®¤ä¸ºæ˜¯ä¸»ç«™ä¸‹çš„è¯·æ±‚")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("ç»¼ä¸Š: åˆ¤æ–­è¯·æ±‚æ˜¯ä¸æ˜¯å‘ç”Ÿè‡ªç¬¬ä¸‰æ–¹ç½‘ç«™æ¥é¢„é˜²å¹¶ä¸èƒ½è¿‡æ»¤æ‰æ‰€æœ‰çš„CSRFæ”»å‡»")]),t._v(" "),a("h4",{attrs:{id:"é™„åŠ é¢å¤–çš„ä¿¡æ¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é™„åŠ é¢å¤–çš„ä¿¡æ¯"}},[t._v("#")]),t._v(" é™„åŠ é¢å¤–çš„ä¿¡æ¯")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Token")])])]),t._v(" "),a("p",[t._v("åœ¨ç”¨æˆ·çš„ç™»é™†æ¥å£, å’ŒéªŒè¯æ˜¯å¦ç™»é™†çš„æ¥å£, æœåŠ¡ç«¯ç”Ÿæˆä¸€ä¸ªHashå¹¶å­˜å‚¨åˆ°Sessionä¸­, åŒæ—¶å°†è¿™ä¸ªHashè¿”å›, åç»­çš„è¯·æ±‚å‘é€éœ€è¦å°†è¿™ä¸ªHashä¸€åŒå‘é€ç»™æœåŠ¡ç«¯(ä¸€èˆ¬æ˜¯è´Ÿè½½åœ¨request headerså†… token: hash, "),a("strong",[t._v("è¿™ä¸ªTokenä¸€å®šä¸èƒ½éšç€cookieå‘é€")]),t._v("), è¿™æ ·æœåŠ¡ç«¯é€šè¿‡headrsçš„hashå’ŒSessionä¸­çš„hashè¿›è¡ŒéªŒè¯,  å°±å¯ä»¥çŸ¥é“è¿™ä¸ªè¯·æ±‚æ˜¯å¦æ˜¯åœ¨ä¸»ç«™ä¸‹å‘é€çš„")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("è¿™æ˜¯å› ä¸ºè¿™ä¸ªhashæ˜¯é€šè¿‡è„šæœ¬å¾—åˆ°çš„, å—åŒæºç­–ç•¥ä¿æŠ¤")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("âš ï¸   : ä¸Šé¢æåˆ°çš„ç­–ç•¥ä¸é€‚ç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿ, ä¸€èˆ¬ä¼ä¸šéƒ½å­˜åœ¨å¾ˆå¤šæœºæˆ¿, åˆ†å¸ƒåœ¨ä¸åŒçš„åœ°æ–¹, æ‰€ä»¥ä½¿ç”¨éšæœºç”ŸæˆHashçš„æ–¹å¼ä¼šé€ æˆä¸åŒæœºå™¨Sessionå†…å­˜å‚¨çš„Hashä¸ä¸€æ ·...")]),t._v(" "),a("p",[a("strong",[t._v("æ‰€ä»¥, åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­, ä¸ä½¿ç”¨éšæœºç”ŸæˆHashçš„ç­–ç•¥, è€Œæ˜¯é€šè¿‡ç”¨æˆ·çš„userId, æœ‰æ•ˆæ—¶é—´... ç”Ÿæˆçš„è®¡ç®—å€¼")]),t._v(", è¿™æ ·æ¯æ¬¡è®¡è¾ƒè®¡ç®—ç»“æœå°±å¯ä»¥éªŒè¯è¯·æ±‚æ˜¯å¦æ¥è‡ªç¬¬ä¸‰æ–¹")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("åŒé‡Cookie")])])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://tech.meituan.com/2018/10/11/fe-security-csrf.html#%E5%8F%8C%E9%87%8Dcookie%E9%AA%8C%E8%AF%81",target:"_blank",rel:"noopener noreferrer"}},[t._v("ç¾å›¢: CSRF"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("å¯¹äº"),a("strong",[t._v("åŒé‡Cookie")]),t._v("æœ‰ä¸€äº›æƒ…å†µæˆ‘ä¸æ˜¯å¾ˆç†è§£")]),t._v(" "),a("ol",[a("li",[t._v("ä¸ºä»€ä¹ˆè¦å°†é¢å¤–çš„è´Ÿè½½ä¿¡æ¯é€šè¿‡ç§Cookieçš„æ–¹å¼ä¸‹å‘ç»™é¡µé¢")])]),t._v(" "),a("p",[t._v("å› ä¸ºåœ¨è®¿é—®é¡µé¢çš„æ—¶å€™, æˆ‘ä»¬éƒ½ä¼šè®¿é—®ä¸€ä¸ªç™»é™†æ¥å£, ä¸ºä»€ä¹ˆä¸åœ¨ç™»é™†æ¥å£è¿”å›")]),t._v(" "),a("p",[t._v("æŒ‰ç…§æˆ‘çš„ç†è§£"),a("strong",[t._v("åŒé‡Cookie")]),t._v("åªæ˜¯ç›¸å¯¹äº"),a("strong",[t._v("Token")]),t._v("ç¼ºå°‘ä¸€ä¸ªé²œåº¦æ ¡éªŒçš„è¿‡ç¨‹, åªæ¯”è¾ƒè´Ÿè½½ä¿¡æ¯æ˜¯å¦æ­£ç¡®, è€Œæ²¡æœ‰æ ¡éªŒè´Ÿè½½ä¿¡æ¯æ˜¯å¦è¿‡æœŸ")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("éªŒè¯ç ")])])]),t._v(" "),a("p",[t._v("å¯¹äºä¸€äº›ç‰¹åˆ«æ•æ„Ÿçš„æ“ä½œä½¿ç”¨éªŒè¯ç æ¥é¿å…CSRF, æ¯”å¦‚æ”¯ä»˜")]),t._v(" "),a("h4",{attrs:{id:"ä¸ä½¿ç”¨cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ä½¿ç”¨cookie"}},[t._v("#")]),t._v(" ä¸ä½¿ç”¨Cookie")]),t._v(" "),a("p",[t._v("CSRFæ˜¯é’ˆå¯¹cookieè¿›è¡Œçš„æ”»å‡»æ‰‹æ®µ, æ‰¾åˆ°ä¸€ç§æ»¡è¶³éœ€æ±‚ä¸”ä¸ä½¿ç”¨cookieçš„ä»£æ›¿æ‰‹æ®µå°±å¥½äº†, æ¯”å¦‚ä¸Šé¢æåˆ°çš„ä½¿ç”¨"),a("code",[t._v("localStorage")]),t._v("å®ç°çˆ¶/å­åŸŸè·³è½¬å…å¯†")]),t._v(" "),a("h3",{attrs:{id:"æµè§ˆå™¨çš„csrfé˜²å¾¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æµè§ˆå™¨çš„csrfé˜²å¾¡"}},[t._v("#")]),t._v(" æµè§ˆå™¨çš„CSRFé˜²å¾¡")]),t._v(" "),a("p",[t._v("é’ˆå¯¹CSRFæµè§ˆå™¨æä¾›äº†"),a("code",[t._v("SameSite Cookie")]),t._v("æ¥è®¾ç½®ä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥å‘é€ç¬¬ä¸‰æ–¹çš„cookie")]),t._v(" "),a("ul",[a("li",[t._v("None")])]),t._v(" "),a("p",[t._v("å‘é€ç¬¬ä¸‰æ–¹Cookie, åªåœ¨Secureä¸‹æ‰å¯ä»¥ä½¿ç”¨")]),t._v(" "),a("ul",[a("li",[t._v("Lax (é»˜è®¤)")])]),t._v(" "),a("p",[t._v("åœ¨æŸäº›æƒ…å†µä¸‹æ‰å¯ä»¥å‘é€ç¬¬ä¸‰æ–¹Cookie, æ¯”å¦‚"),a("code",[t._v("<a />")])]),t._v(" "),a("ul",[a("li",[t._v("Strict")])]),t._v(" "),a("p",[t._v("æ°¸è¿œä¸å‘é€ç¬¬ä¸‰æ–¹Cookie")]),t._v(" "),a("div",{staticClass:"language-javaScript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Set-Cookie'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'userId=AxsEZmec; SameSite=Lax'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nres"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Set-Cookie'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'userId=AxsEZmec; SameSite=None; Secure;'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("h2",{attrs:{id:"å‚è€ƒæ–‡ç« "}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒæ–‡ç« "}},[t._v("#")]),t._v(" å‚è€ƒæ–‡ç« ")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://tech.meituan.com/2018/10/11/fe-security-csrf.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("å‰ç«¯å®‰å…¨ç³»åˆ—ï¼ˆäºŒï¼‰ï¼šå¦‚ä½•é˜²æ­¢CSRFæ”»å‡»ï¼Ÿ - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=r.exports}}]);