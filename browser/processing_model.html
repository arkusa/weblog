<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Processing Model | askura</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="askura's weblog">
    <link rel="preload" href="/weblog/assets/css/0.styles.bd84e9de.css" as="style"><link rel="preload" href="/weblog/assets/js/app.73afb69f.js" as="script"><link rel="preload" href="/weblog/assets/js/2.b1d48028.js" as="script"><link rel="preload" href="/weblog/assets/js/12.1aa44b2f.js" as="script"><link rel="prefetch" href="/weblog/assets/js/10.5e5257d2.js"><link rel="prefetch" href="/weblog/assets/js/11.ac268403.js"><link rel="prefetch" href="/weblog/assets/js/13.d254d810.js"><link rel="prefetch" href="/weblog/assets/js/14.99e6dc6d.js"><link rel="prefetch" href="/weblog/assets/js/15.b4307193.js"><link rel="prefetch" href="/weblog/assets/js/16.889db329.js"><link rel="prefetch" href="/weblog/assets/js/17.f907b394.js"><link rel="prefetch" href="/weblog/assets/js/18.eea8f088.js"><link rel="prefetch" href="/weblog/assets/js/19.84c994ab.js"><link rel="prefetch" href="/weblog/assets/js/20.91a0790a.js"><link rel="prefetch" href="/weblog/assets/js/21.f225089f.js"><link rel="prefetch" href="/weblog/assets/js/22.4271b9d7.js"><link rel="prefetch" href="/weblog/assets/js/23.29f5f4b4.js"><link rel="prefetch" href="/weblog/assets/js/24.12b1d527.js"><link rel="prefetch" href="/weblog/assets/js/25.e84d37ad.js"><link rel="prefetch" href="/weblog/assets/js/26.b50519d9.js"><link rel="prefetch" href="/weblog/assets/js/27.15235234.js"><link rel="prefetch" href="/weblog/assets/js/28.8a9df4eb.js"><link rel="prefetch" href="/weblog/assets/js/29.9b595a2b.js"><link rel="prefetch" href="/weblog/assets/js/3.94d94b8f.js"><link rel="prefetch" href="/weblog/assets/js/30.cf77db1b.js"><link rel="prefetch" href="/weblog/assets/js/31.27e718fb.js"><link rel="prefetch" href="/weblog/assets/js/32.a51ac16d.js"><link rel="prefetch" href="/weblog/assets/js/33.e2fb7862.js"><link rel="prefetch" href="/weblog/assets/js/34.4f32cadf.js"><link rel="prefetch" href="/weblog/assets/js/4.a24ff65c.js"><link rel="prefetch" href="/weblog/assets/js/5.a6ef23be.js"><link rel="prefetch" href="/weblog/assets/js/6.c64d5164.js"><link rel="prefetch" href="/weblog/assets/js/7.05e16fa0.js"><link rel="prefetch" href="/weblog/assets/js/8.f29158ab.js"><link rel="prefetch" href="/weblog/assets/js/9.7ebc8f6b.js">
    <link rel="stylesheet" href="/weblog/assets/css/0.styles.bd84e9de.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/weblog/" class="home-link router-link-active"><!----> <span class="site-name">askura</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç½‘ç»œ" class="dropdown-title"><span class="title">ç½‘ç»œ</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç½‘ç»œ" class="mobile-dropdown-title"><span class="title">ç½‘ç»œ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          HTTP
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/net/http/cookie.html" class="nav-link">
  COOKIE
</a></li></ul></li><li class="dropdown-item"><h4>
          webå®‰å…¨
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/safety/web/csrf.html" class="nav-link">
  CSRF
</a></li><li class="dropdown-subitem"><a href="/weblog/safety/web/xss.html" class="nav-link">
  XSS
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GIT" class="dropdown-title"><span class="title">GIT</span> <span class="arrow down"></span></button> <button type="button" aria-label="GIT" class="mobile-dropdown-title"><span class="title">GIT</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          è¿œç¨‹ä»“åº“
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/git/remotes/clone.html" class="nav-link">
  clone
</a></li><li class="dropdown-subitem"><a href="/weblog/git/remotes/fetch.html" class="nav-link">
  fetch
</a></li><li class="dropdown-subitem"><a href="/weblog/git/remotes/pull.html" class="nav-link">
  pull
</a></li><li class="dropdown-subitem"><a href="/weblog/git/remotes/push.html" class="nav-link">
  push
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/weblog/git/branch.html" class="nav-link">
  branch
</a></li><li class="dropdown-item"><!----> <a href="/weblog/git/checkout.html" class="nav-link">
  checkout
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CSS" class="dropdown-title"><span class="title">CSS</span> <span class="arrow down"></span></button> <button type="button" aria-label="CSS" class="mobile-dropdown-title"><span class="title">CSS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Layout
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/css/layout/holy_grail.html" class="nav-link">
  åœ£æ¯å¸ƒå±€æ­ç§˜
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/weblog/css/contain_block.html" class="nav-link">
  åŒ…å«å—(positionå®šä½)
</a></li><li class="dropdown-item"><!----> <a href="/weblog/css/stacking_context.html" class="nav-link">
  Stacking Context
</a></li><li class="dropdown-item"><!----> <a href="/weblog/css/box_model.html" class="nav-link">
  Box Model
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="VIM" class="dropdown-title"><span class="title">VIM</span> <span class="arrow down"></span></button> <button type="button" aria-label="VIM" class="mobile-dropdown-title"><span class="title">VIM</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          æ’ä»¶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/vim/plugins/airline.html" class="nav-link">
  airline
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="TMUX" class="dropdown-title"><span class="title">TMUX</span> <span class="arrow down"></span></button> <button type="button" aria-label="TMUX" class="mobile-dropdown-title"><span class="title">TMUX</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/weblog/tmux/theme.html" class="nav-link">
  theme
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="REDUX" class="dropdown-title"><span class="title">REDUX</span> <span class="arrow down"></span></button> <button type="button" aria-label="REDUX" class="mobile-dropdown-title"><span class="title">REDUX</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/weblog/redux/struct.html" class="nav-link">
  æˆ‘ç†è§£çš„redux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Browser" class="dropdown-title"><span class="title">Browser</span> <span class="arrow down"></span></button> <button type="button" aria-label="Browser" class="mobile-dropdown-title"><span class="title">Browser</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Net
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/browser/net/cross_domain.html" class="nav-link">
  Cross Domain
</a></li><li class="dropdown-subitem"><a href="/weblog/browser/net/jsonp.html" class="nav-link">
  JSONP
</a></li><li class="dropdown-subitem"><a href="/weblog/browser/net/iframe_cross.html" class="nav-link">
  IFrame Cross
</a></li></ul></li><li class="dropdown-item"><h4>
          Render
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/browser/render/parse_document.html" class="nav-link">
  Parse Document
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/weblog/browser/processing_model.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Processing Model
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow down"></span></button> <button type="button" aria-label="JavaScript" class="mobile-dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          ES6
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/javascript/ES6/Promise/api.html" class="nav-link">
  Promise API
</a></li><li class="dropdown-subitem"><a href="/weblog/javascript/ES6/Promise/polyfill.html" class="nav-link">
  Promise Polyfill
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/weblog/javascript/regExp.html" class="nav-link">
  RegExp
</a></li><li class="dropdown-item"><!----> <a href="/weblog/javascript/function.html" class="nav-link">
  å‡½æ•°
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å‰ç«¯å·¥ç¨‹åŒ–" class="dropdown-title"><span class="title">å‰ç«¯å·¥ç¨‹åŒ–</span> <span class="arrow down"></span></button> <button type="button" aria-label="å‰ç«¯å·¥ç¨‹åŒ–" class="mobile-dropdown-title"><span class="title">å‰ç«¯å·¥ç¨‹åŒ–</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/weblog/engineering/tree_shaking.html" class="nav-link">
  Tree Shaking
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="è®¾è®¡æ¨¡å¼" class="dropdown-title"><span class="title">è®¾è®¡æ¨¡å¼</span> <span class="arrow down"></span></button> <button type="button" aria-label="è®¾è®¡æ¨¡å¼" class="mobile-dropdown-title"><span class="title">è®¾è®¡æ¨¡å¼</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          OOP
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/design_pattern/oop/decorator.html" class="nav-link">
  Decorator Pattern
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿" class="dropdown-title"><span class="title">ä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿</span> <span class="arrow down"></span></button> <button type="button" aria-label="ä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿" class="mobile-dropdown-title"><span class="title">ä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/weblog/interesting/git_credential.html" class="nav-link">
  è®¨åŒçš„credential.helper=osxkeychain
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue" class="dropdown-title"><span class="title">vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue" class="mobile-dropdown-title"><span class="title">vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/weblog/vue/preface.html" class="nav-link">
  å¯¹Vueçš„è®¤çŸ¥
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Threejs" class="dropdown-title"><span class="title">Threejs</span> <span class="arrow down"></span></button> <button type="button" aria-label="Threejs" class="mobile-dropdown-title"><span class="title">Threejs</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/weblog/threejs/struct.html" class="nav-link">
  åˆè¯†webgl
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç½‘ç»œ" class="dropdown-title"><span class="title">ç½‘ç»œ</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç½‘ç»œ" class="mobile-dropdown-title"><span class="title">ç½‘ç»œ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          HTTP
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/net/http/cookie.html" class="nav-link">
  COOKIE
</a></li></ul></li><li class="dropdown-item"><h4>
          webå®‰å…¨
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/safety/web/csrf.html" class="nav-link">
  CSRF
</a></li><li class="dropdown-subitem"><a href="/weblog/safety/web/xss.html" class="nav-link">
  XSS
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GIT" class="dropdown-title"><span class="title">GIT</span> <span class="arrow down"></span></button> <button type="button" aria-label="GIT" class="mobile-dropdown-title"><span class="title">GIT</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          è¿œç¨‹ä»“åº“
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/git/remotes/clone.html" class="nav-link">
  clone
</a></li><li class="dropdown-subitem"><a href="/weblog/git/remotes/fetch.html" class="nav-link">
  fetch
</a></li><li class="dropdown-subitem"><a href="/weblog/git/remotes/pull.html" class="nav-link">
  pull
</a></li><li class="dropdown-subitem"><a href="/weblog/git/remotes/push.html" class="nav-link">
  push
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/weblog/git/branch.html" class="nav-link">
  branch
</a></li><li class="dropdown-item"><!----> <a href="/weblog/git/checkout.html" class="nav-link">
  checkout
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CSS" class="dropdown-title"><span class="title">CSS</span> <span class="arrow down"></span></button> <button type="button" aria-label="CSS" class="mobile-dropdown-title"><span class="title">CSS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Layout
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/css/layout/holy_grail.html" class="nav-link">
  åœ£æ¯å¸ƒå±€æ­ç§˜
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/weblog/css/contain_block.html" class="nav-link">
  åŒ…å«å—(positionå®šä½)
</a></li><li class="dropdown-item"><!----> <a href="/weblog/css/stacking_context.html" class="nav-link">
  Stacking Context
</a></li><li class="dropdown-item"><!----> <a href="/weblog/css/box_model.html" class="nav-link">
  Box Model
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="VIM" class="dropdown-title"><span class="title">VIM</span> <span class="arrow down"></span></button> <button type="button" aria-label="VIM" class="mobile-dropdown-title"><span class="title">VIM</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          æ’ä»¶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/vim/plugins/airline.html" class="nav-link">
  airline
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="TMUX" class="dropdown-title"><span class="title">TMUX</span> <span class="arrow down"></span></button> <button type="button" aria-label="TMUX" class="mobile-dropdown-title"><span class="title">TMUX</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/weblog/tmux/theme.html" class="nav-link">
  theme
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="REDUX" class="dropdown-title"><span class="title">REDUX</span> <span class="arrow down"></span></button> <button type="button" aria-label="REDUX" class="mobile-dropdown-title"><span class="title">REDUX</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/weblog/redux/struct.html" class="nav-link">
  æˆ‘ç†è§£çš„redux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Browser" class="dropdown-title"><span class="title">Browser</span> <span class="arrow down"></span></button> <button type="button" aria-label="Browser" class="mobile-dropdown-title"><span class="title">Browser</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Net
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/browser/net/cross_domain.html" class="nav-link">
  Cross Domain
</a></li><li class="dropdown-subitem"><a href="/weblog/browser/net/jsonp.html" class="nav-link">
  JSONP
</a></li><li class="dropdown-subitem"><a href="/weblog/browser/net/iframe_cross.html" class="nav-link">
  IFrame Cross
</a></li></ul></li><li class="dropdown-item"><h4>
          Render
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/browser/render/parse_document.html" class="nav-link">
  Parse Document
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/weblog/browser/processing_model.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Processing Model
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow down"></span></button> <button type="button" aria-label="JavaScript" class="mobile-dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          ES6
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/javascript/ES6/Promise/api.html" class="nav-link">
  Promise API
</a></li><li class="dropdown-subitem"><a href="/weblog/javascript/ES6/Promise/polyfill.html" class="nav-link">
  Promise Polyfill
</a></li></ul></li><li class="dropdown-item"><!----> <a href="/weblog/javascript/regExp.html" class="nav-link">
  RegExp
</a></li><li class="dropdown-item"><!----> <a href="/weblog/javascript/function.html" class="nav-link">
  å‡½æ•°
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å‰ç«¯å·¥ç¨‹åŒ–" class="dropdown-title"><span class="title">å‰ç«¯å·¥ç¨‹åŒ–</span> <span class="arrow down"></span></button> <button type="button" aria-label="å‰ç«¯å·¥ç¨‹åŒ–" class="mobile-dropdown-title"><span class="title">å‰ç«¯å·¥ç¨‹åŒ–</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/weblog/engineering/tree_shaking.html" class="nav-link">
  Tree Shaking
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="è®¾è®¡æ¨¡å¼" class="dropdown-title"><span class="title">è®¾è®¡æ¨¡å¼</span> <span class="arrow down"></span></button> <button type="button" aria-label="è®¾è®¡æ¨¡å¼" class="mobile-dropdown-title"><span class="title">è®¾è®¡æ¨¡å¼</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          OOP
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/weblog/design_pattern/oop/decorator.html" class="nav-link">
  Decorator Pattern
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿" class="dropdown-title"><span class="title">ä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿</span> <span class="arrow down"></span></button> <button type="button" aria-label="ä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿" class="mobile-dropdown-title"><span class="title">ä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/weblog/interesting/git_credential.html" class="nav-link">
  è®¨åŒçš„credential.helper=osxkeychain
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue" class="dropdown-title"><span class="title">vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue" class="mobile-dropdown-title"><span class="title">vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/weblog/vue/preface.html" class="nav-link">
  å¯¹Vueçš„è®¤çŸ¥
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Threejs" class="dropdown-title"><span class="title">Threejs</span> <span class="arrow down"></span></button> <button type="button" aria-label="Threejs" class="mobile-dropdown-title"><span class="title">Threejs</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/weblog/threejs/struct.html" class="nav-link">
  åˆè¯†webgl
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Processing Model</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/weblog/browser/processing_model.html#event-loop" class="sidebar-link">Event Loop</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#ä»€ä¹ˆæ˜¯event-loop" class="sidebar-link">ä»€ä¹ˆæ˜¯Event Loop</a></li><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#event-loop-æµç¨‹" class="sidebar-link">Event Loop æµç¨‹</a></li><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#taskå’Œjobäº‹ä»¶" class="sidebar-link">Taskå’ŒJobäº‹ä»¶</a></li><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#event-loopçš„å¼€å§‹" class="sidebar-link">Event Loopçš„å¼€å§‹</a></li><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#å®è·µ" class="sidebar-link">å®è·µ</a></li></ul></li><li><a href="/weblog/browser/processing_model.html#ui-render" class="sidebar-link">UI Render</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#transitionåŠ¨ç”»" class="sidebar-link">TransitionåŠ¨ç”»</a></li><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#guiå¼•æ“çš„å”¤é†’" class="sidebar-link">GUIå¼•æ“çš„å”¤é†’</a></li></ul></li><li><a href="/weblog/browser/processing_model.html#settimeout-setinterval-requsetanimationframeå·®å¼‚" class="sidebar-link">setTimeout, setInterval, requsetAnimationFrameå·®å¼‚</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#æµè§ˆå™¨æ˜¯å¦‚ä½•æ¸²æŸ“å…ƒç´ çš„" class="sidebar-link">æµè§ˆå™¨æ˜¯å¦‚ä½•æ¸²æŸ“å…ƒç´ çš„</a></li><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#è·³å¸§" class="sidebar-link">è·³å¸§</a></li><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#å¡é¡¿" class="sidebar-link">å¡é¡¿</a></li><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#setinterval" class="sidebar-link">setInterval</a></li><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#settimeout" class="sidebar-link">setTimeout</a></li><li class="sidebar-sub-header"><a href="/weblog/browser/processing_model.html#requestanimationframe" class="sidebar-link">requestAnimationFrame</a></li></ul></li><li><a href="/weblog/browser/processing_model.html#node-event-loop" class="sidebar-link">Node Event Loop</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="processing-model"><a href="#processing-model" class="header-anchor">#</a> Processing Model</h1> <p>æˆ‘ä»¬çŸ¥é“<code>javascript</code>æ˜¯å•çº¿ç¨‹, ä½†æ˜¯åœ¨å®é™…åº”ç”¨ä¸­æ— æ³•é¿å…çš„è¦ä½¿ç”¨åˆ°å¼‚æ­¥æ“ä½œ</p> <p>e.g: <code>xhrè¯·æ±‚</code>, <code>click event</code>, <code>timout</code>...</p> <p>æ—¢ç„¶<code>javascript</code>å­˜åœ¨ä¸€äº›å¼‚æ­¥API, é‚£ä¹ˆ<strong>jså¼•æ“</strong>å¦‚ä½•è°ƒåº¦åŒæ­¥è„šæœ¬å’Œå¼‚æ­¥è„šæœ¬å°±æˆä¸ºäº†ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜</p> <p><strong>jså¼•æ“</strong>å¯¹åŒæ­¥/å¼‚æ­¥è„šæœ¬çš„è°ƒåº¦è¿‡ç¨‹å°±æ˜¯æœ¬ç« è¦è®²è¿°çš„<code>Processing Model</code>, ä¹Ÿå°±æ˜¯å¸¸è¯´çš„<code>Event Loop</code></p> <div class="custom-block warning"><p class="custom-block-title">- æ³¨æ„</p> <p>æœ¬ç¯‡å¦‚æœæ²¡æœ‰ç‰¹æ„æåŠéƒ½æ˜¯æŒ‡ æµè§ˆå™¨å¼•æ“çš„<code>Event Loop</code></p> <p>å¯¹äºNodeç¯å¢ƒä¸‹çš„<code>Event Loop</code>, æ²¡æœ‰åšè¿‡è¯¦ç»†çš„å­¦ä¹ , ç›®å‰æš‚ä¸æåŠ</p></div> <p>çœ‹ä¸€ä¸‹ä¸‹é¢çš„ğŸŒ° (è¿™æ˜¯å¤§å­¦çš„æ—¶å€™é¢è¯•ä»Šæ—¥å¤´æ¡çš„ä¸€ä¸ªé¢è¯•é¢˜, ä¹Ÿæ˜¯é€šè¿‡è¿™ä¸ªé¢è¯•é¢˜æ‰å¯¹<code>Event Loop</code>æœ‰äº†æ·±å…¥çš„å­¦ä¹ )</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// å†™å‡ºè¾“å‡ºé¡ºåº</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2 end'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Promise'</span><span class="token punctuation">)</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span>

<span class="token comment">// è¿™é‡Œç›´æ¥ç»™å‡ºç­”æ¡ˆ</span>
<span class="token comment">// script start</span>
<span class="token comment">// async2 end</span>
<span class="token comment">// Promise</span>
<span class="token comment">// script end</span>
<span class="token comment">// async1 end</span>
<span class="token comment">// promise1</span>
<span class="token comment">// promise2</span>
<span class="token comment">// setTimeout</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>å¦‚æœä½ èƒ½å¯¹ä¸Šé¢çš„é¡ºåºç»™å‡ºåˆç†çš„è§£é‡Š, æˆ‘ç›¸ä¿¡ä½ å·²ç»æŒæ¡<code>Event Loop</code>äº†, ä½†æ˜¯æˆ‘è¿˜æ˜¯å»ºè®®ä½ çœ‹é˜…è¯»ä¸€ä¸‹</p> <ul><li><p><a href="/weblog/browser/processing_model.html#ui-render">UI Render</a></p></li> <li><p><a href="/weblog/browser/processing_model.html#settimeout-setinterval-requsetanimationframeå·®å¼‚">setTimeout...</a></p></li></ul> <p>å¯èƒ½ä½ ä¼šå¾—åˆ°ä¸€äº›é¢å¤–çš„æ”¶è·</p> <h2 id="event-loop"><a href="#event-loop" class="header-anchor">#</a> Event Loop</h2> <h3 id="ä»€ä¹ˆæ˜¯event-loop"><a href="#ä»€ä¹ˆæ˜¯event-loop" class="header-anchor">#</a> ä»€ä¹ˆæ˜¯Event Loop</h3> <p>å‰é¢æåˆ°äº†<code>Event Loop</code>å°±æ˜¯<strong>jså¼•æ“</strong>å¯¹åŒæ­¥/å¼‚æ­¥ä»»åŠ¡çš„è°ƒåº¦ç®—æ³•</p> <p>å¦‚æœä½ çš„è‹±æ–‡èƒ½åŠ›å¯ä»¥çš„è¯, æˆ‘æ¨èä½ é˜…è¯»<a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loop-processing-model" target="_blank" rel="noopener noreferrer">event-loop-process-model-standard<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>æˆ–è€…ä½ ä¹Ÿå¯ä»¥çœ‹ä¸€ä¸‹è¿™ç¯‡æ–‡ç« <a href="https://github.com/aooy/blog/issues/5" target="_blank" rel="noopener noreferrer">ä»event loopè§„èŒƒæ¢ç©¶javaScriptå¼‚æ­¥åŠæµè§ˆå™¨æ›´æ–°æ¸²æŸ“æ—¶æœº<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, è¿™ç¯‡æ–‡ç« å†…æœ‰å¯¹ä¸Šè¿°æ ‡å‡†çš„ç¿»è¯‘</p> <p>å¯¹äº<strong>macrotask queue</strong>å’Œ<strong>microtask queue</strong>è¿™é‡Œä¸åšè¿‡å¤šèµ˜è¿°</p> <hr> <p>è¿™é‡Œä»‹ç»å‡ ä¸ªH5æ ‡å‡†æåˆ°çš„ä¸€äº›åè¯</p> <ul><li><p><strong>Task</strong></p> <p><strong>macrotask queue</strong>ä¸­æœ€å…ˆå…¥é˜Ÿçš„å›è°ƒå‡½æ•°</p> <div class="custom-block warning"><p class="custom-block-title">- æ³¨æ„</p> <p>åŒæ­¥è„šæœ¬ä¹Ÿæ˜¯ä¸€ä¸ª<strong>Task</strong></p></div></li> <li><p><strong>Job</strong></p> <p><strong>microtask queue</strong>ä¸­æœ€å…ˆå…¥é˜Ÿçš„å›è°ƒå‡½æ•°</p></li> <li><p><strong>Jobs</strong></p> <p><strong>microtask queue</strong>ä¸­çš„æ‰€æœ‰å›è°ƒå‡½æ•°</p></li></ul> <h3 id="event-loop-æµç¨‹"><a href="#event-loop-æµç¨‹" class="header-anchor">#</a> Event Loop æµç¨‹</h3> <p><img src="/weblog/imgs/browser_event_loop/event_loop.png" alt="event loop"></p> <p>æ„æ€æ˜¯, æµè§ˆå™¨åœ¨æ¯ä¸€æ¬¡çš„<code>Loop</code>ä¸­</p> <ol><li><p><strong>Task</strong>é˜¶æ®µ: å…ˆæ‰§è¡Œ<strong>Task</strong>, å¦‚æœ<strong>Task</strong>ä¸å­˜åœ¨çš„è¯å°±è·³è¿‡<strong>Task</strong>é˜¶æ®µ</p></li> <li><p><strong>Jobs</strong>é˜¶æ®µ: <strong>Task</strong>é˜¶æ®µå®Œæˆå, è¿›å…¥<strong>Jobs</strong>é˜¶æ®µ, è¿™ä¸ªæ—¶å€™ä¼šæ‰§è¡Œæ‰€æœ‰å­˜åœ¨çš„<strong>Job</strong>, æ²¡æœ‰åˆ™è·³è¿‡</p> <p>åœ¨<strong>Jobs</strong>é˜¶æ®µè¿˜å¯èƒ½ä¼šäº§ç”Ÿæ–°çš„<strong>Job</strong></p> <p>e.g.</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'job 0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'job 1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// job 1 å°±æ˜¯åœ¨æœ¬æ¬¡jobsé˜¶æ®µä¸­äº§ç”Ÿçš„job</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>æ–°çš„<strong>job</strong>ä¹Ÿä¼šåœ¨å½“å‰<strong>Jobs</strong>é˜¶æ®µæ‰§è¡Œ, <strong>Jobs</strong>é˜¶æ®µå°±æ˜¯è¦æ¸…ç©ºæ‰€æœ‰çš„<strong>microtask queue</strong></p></li> <li><p><strong>IndexDB</strong>é˜¶æ®µ: æ¸…ç†æ‰€æœ‰çš„<strong>IndexDB</strong>äº‹åŠ¡</p></li> <li><p><strong>UI Render</strong>é˜¶æ®µ: <code>javascriptå¼•æ“</code>è¢«æŒ‚èµ·, <code>GUIå¼•æ“</code>å”¤é†’, CPUå¼€å§‹æ ¹æ®<code>RenderLayoutObject</code>åˆ¶ä½œçº¹ç†ä¼ å…¥<code>GPU</code></p></li> <li><p>ç­‰å¾…ä¸‹ä¸€ä¸ª<strong>Task</strong>çš„å“åº”ï¼Œè¿›è¡Œä¸‹ä¸€æ¬¡çš„<code>Loop</code></p></li></ol> <hr> <h3 id="taskå’Œjobäº‹ä»¶"><a href="#taskå’Œjobäº‹ä»¶" class="header-anchor">#</a> Taskå’ŒJobäº‹ä»¶</h3> <h4 id="task"><a href="#task" class="header-anchor">#</a> Task</h4> <ul><li><code>setTimeout</code></li> <li><code>setInterval</code></li> <li><code>requestAnimationFrame</code></li> <li><code>xhr</code></li> <li><code>DOM Event</code></li> <li><code>MessageChannel</code></li></ul> <h4 id="job"><a href="#job" class="header-anchor">#</a> Job</h4> <ul><li><code>Promise.then</code></li> <li><code>MutationObserver</code></li></ul> <p>å€¼å¾—æ³¨æ„çš„æ˜¯æµè§ˆå™¨å¹¶ä¸æ˜¯åªå­˜åœ¨ä¸€ä¸ª<strong>macrotask queue</strong>å’Œä¸€ä¸ª<strong>microtask queue</strong>ç„¶åå°†å›è°ƒå‡½æ•°æ¨å…¥é˜Ÿåˆ—ä¸­</p> <p>è€Œæ˜¯å¯¹äºä¸åŒç±»å‹çš„å›è°ƒå‡½æ•°, æ¨å…¥ç›¸åº”ç±»å‹çš„é˜Ÿåˆ—ä¸­, åœ¨<code>Event Loop</code>è°ƒåº¦çš„æ—¶å€™ä»å‡ ä¸ªé˜Ÿåˆ—ä¸­é€‰æ‹©<code>Task</code>å’Œ<code>Job</code></p> <p>å³:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>macrotask queue:
  timer queue(setTimeout):
  xhr queue(xhr):
  DOM Event:

microtask queue:
  Promise:
  MutationObserver:
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="event-loopçš„å¼€å§‹"><a href="#event-loopçš„å¼€å§‹" class="header-anchor">#</a> Event Loopçš„å¼€å§‹</h3> <p>å½“è„šæœ¬å¼€å§‹æ‰§è¡Œçš„æ—¶å€™<code>Event Loop</code>å°±å·²ç»å¼€å§‹å·¥ä½œäº†</p> <p>ä¸€ä¸ªé”™è¯¯çš„ç†è§£æ˜¯: <strong>å½“åŒæœ¬è„šæœ¬æ‰§è¡Œå®Œæ¯•å, æ‰å¼€å§‹<code>Event Loop</code>çš„è°ƒåº¦</strong> âŒ  âŒ</p> <p>ğŸŒ°</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timeout'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> te <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">while</span><span class="token punctuation">(</span>te <span class="token operator">-</span> ts <span class="token operator">&lt;</span> <span class="token number">3000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  te <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'job 0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'job 1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æŒ‰ç…§é”™è¯¯çš„ç†è§£, å½“åŒæ­¥è„šæœ¬æ‰§è¡Œå®Œæ¯•åï¼Œè¿›å…¥Event Loopè°ƒåº¦</span>
<span class="token comment">// æ­¤æ—¶åº”è¯¥ä¼˜å…ˆæ‰§è¡ŒTask, å³: timeout</span>
<span class="token comment">// æ‰€ä»¥æœŸæœ›çš„è¾“å‡ºåº”è¯¥æ˜¯</span>
<span class="token comment">// start</span>
<span class="token comment">// timeout</span>
<span class="token comment">// job 0</span>
<span class="token comment">// job 1</span>

<span class="token comment">// ä½†æ˜¯å®é™…å´å¹¶ä¸æ˜¯å¦‚æ­¤</span>
<span class="token comment">// start</span>
<span class="token comment">// job 0</span>
<span class="token comment">// job 1</span>
<span class="token comment">// timeout</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p><strong>è¿™ä¹Ÿå°±æ˜¯å‰é¢æåˆ°çš„, åŒæ­¥è„šæœ¬æ˜¯ä¸€ä¸ªTask</strong></p> <h3 id="å®è·µ"><a href="#å®è·µ" class="header-anchor">#</a> å®è·µ</h3> <p>é‡‡ç”¨æœ€å‰é¢æåˆ°çš„ğŸŒ°</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2 end'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Promise'</span><span class="token punctuation">)</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span>

<span class="token comment">// åŒæ­¥è„šæœ¬çš„æ‰§è¡Œå°±å·²ç»å¼€å§‹Event Loop</span>
<span class="token comment">// ---------------- Task é˜¶æ®µ ------------------------</span>
<span class="token comment">// 1. console.log(script start)</span>
<span class="token comment">// 2. async1();</span>
<span class="token comment">//    2.1. await async2();</span>
<span class="token comment">//      2.1.1. async2(); console.log(async2 end);</span>
<span class="token comment">//      2.1.2. async2()è¿”å›äº†ä¸€ä¸ªresolveçŠ¶æ€çš„promise</span>
<span class="token comment">//    2.2. Promise queue è¢«æ¨å…¥äº†ä¸€ä¸ªjob(job 0 -&gt; console.log(async1 end))</span>
<span class="token comment">// 3. setTimeout(); è°ƒèµ·æµè§ˆå™¨timerçº¿ç¨‹, åœ¨0såå°†console.log(setTimeout) æ¨å…¥ Timeout queue (è¿™é‡Œä¸è€ƒè™‘çº³å…¥æ ‡å‡†çš„4ms, å› ä¸ºç»è¿‡æˆ‘æµ‹è¯•å‘ç°setTimeout(callback, 0)å¹¶ä¸æ€»æ˜¯4ms, è¿˜å¯èƒ½æ˜¯1m..., åŒæ—¶0sä¹Ÿæ›´èƒ½è¯´æ˜é—®é¢˜)</span>
<span class="token comment">// 4. new Promise(); -&gt; console.log(Promise);</span>
<span class="token comment">//    4.1 å°†console.log('promise1')ä½œä¸ºjobæ¨å…¥Promise queue(job 1 -&gt; console.log('promise1'))</span>
<span class="token comment">// 5. console.log('script end')</span>
<span class="token comment">// å‡½æ•°çš„ä¼ªè°ƒç”¨æ ˆä¸º</span>

<span class="token comment">// callback stack(å®é™…çš„è°ƒç”¨æ ˆä¸æ˜¯è¿™æ ·çš„, è¿™é‡Œåªæ˜¯ä¸ºäº†æ›´å¥½çš„è¯´æ˜é—®é¢˜ï¼Œéœ€è¦æ³¨æ„, è¿™é‡Œæ›´åƒæ˜¯callback queue):</span>
<span class="token comment">//    console.log(script start); // 1</span>
<span class="token comment">//    console.log(async2 end);   // 2.1.1</span>
<span class="token comment">//    console.log(Promise);      // 4</span>
<span class="token comment">//    console.log(script end);   // 5</span>

<span class="token comment">// macrotask queue:</span>
<span class="token comment">//      timeout queue:</span>
<span class="token comment">//          console.log(setTimeout); // 3</span>

<span class="token comment">// microtask queue</span>
<span class="token comment">//      promise queue:</span>
<span class="token comment">//          job0 -&gt; console.log(async1 end)  // 2.2</span>
<span class="token comment">//          job1 -&gt; console.log(promise1)    // 4.1</span>

<span class="token comment">// æ‰§è¡Œcallback stack</span>
<span class="token comment">// script start</span>
<span class="token comment">// async2 end</span>
<span class="token comment">// Promise</span>
<span class="token comment">// script end</span>

<span class="token comment">// ------------Task é˜¶æ®µç»“æŸ, è¿›å…¥Jobsé˜¶æ®µ-----------------</span>
<span class="token comment">// å°†microtask queue æŒ‰ç…§ä¾æ¬¡å‡ºé˜Ÿï¼Œå‹å…¥callback stack</span>
<span class="token comment">// callback stack</span>
<span class="token comment">//    job0 -&gt; console.log(async1 end)  // 2.2</span>
<span class="token comment">//    job1 -&gt; console.log(promise1)    // 4.1</span>

<span class="token comment">// macrotask queue:</span>
<span class="token comment">//      timeout queue:</span>
<span class="token comment">//          console.log(setTimeout); // 3</span>

<span class="token comment">// microtask queue</span>
<span class="token comment">//      promise queue:</span>
<span class="token comment">//</span>

<span class="token comment">// æ‰§è¡Œcallback stack</span>
<span class="token comment">// async1 end</span>
<span class="token comment">// promise1</span>

<span class="token comment">// ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ åœ¨æ‰§è¡Œjob1ç»“æŸå, promise queue åˆå…¥é˜Ÿäº†æ–°çš„job(job 2 -&gt; console.log(promise2))</span>
<span class="token comment">// microtask queue</span>
<span class="token comment">//      promise queue:</span>
<span class="token comment">//          job 2 -&gt; console.log(promise2)</span>

<span class="token comment">// æ¨å…¥callback stack æ‰§è¡Œåå¾—åˆ°</span>

<span class="token comment">// microtask queue</span>
<span class="token comment">//      promise queue:</span>

<span class="token comment">// Jobsé˜¶æ®µç»“æŸ</span>

<span class="token comment">// -------------- IndexDB äº‹åŠ¡ ---------------------</span>
<span class="token comment">// -------------- UI Render é˜¶æ®µ -------------------</span>

<span class="token comment">// æ­¤æ—¶macrotask Queueè¿˜å­˜åœ¨ä¸€ä¸ªTask</span>
<span class="token comment">// macrotask queue:</span>
<span class="token comment">//      timeout queue:</span>
<span class="token comment">//          console.log(setTimeout); // 3</span>

<span class="token comment">// è¿›å…¥ä¸‹ä¸€æ¬¡ Loop çš„ Taské˜¶æ®µ</span>

<span class="token comment">// æ‰€ä»¥èƒ½å¾—åˆ°</span>
<span class="token comment">// script start</span>
<span class="token comment">// async2 end</span>
<span class="token comment">// Promise</span>
<span class="token comment">// script end</span>
<span class="token comment">// async1 end</span>
<span class="token comment">// promise1</span>
<span class="token comment">// promise2</span>
<span class="token comment">// setTimeout</span>
<span class="token comment">// è¿™æ ·çš„è¾“å‡ºç»“æœ</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br></div></div><h2 id="ui-render"><a href="#ui-render" class="header-anchor">#</a> UI Render</h2> <p><code>UI Render</code>é˜¶æ®µ, <strong>GUIå¼•æ“</strong>å¼€å§‹å·¥ä½œ, <strong>javascriptå¼•æ“</strong>è¢«æŒ‚èµ·, <strong>CPU</strong>å¼€å§‹ç»˜åˆ¶çº¹ç†è¾“å…¥<strong>GPU</strong></p> <p><code>UI Render</code>æ˜¯æµè§ˆå™¨å®ç°<code>batch render</code>çš„æ ¸å¿ƒé€»è¾‘</p> <p>çœ‹ä¸€ä¸‹ğŸŒ°</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'200px'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'300px'</span><span class="token punctuation">;</span>

<span class="token comment">// è¿™æ ·çš„ä»£ç æµè§ˆå™¨åªä¼šåˆ¶ä½œä¸€ä¸ªçº¹ç†, è€Œä¸æ˜¯åˆ¶ä½œ2ä¸ªçº¹ç†</span>

<span class="token comment">// å¯ä»¥è¿™æ ·ç†è§£</span>
<span class="token comment">// GUIå¼•æ“ç»´æŠ¤äº†ä¸€ä¸ªé˜Ÿåˆ—</span>

<span class="token comment">// åœ¨æ‰§è¡Œdiv.style.top = '200px'; æ—¶ </span>
<span class="token comment">// javascript å¼•æ“ é€šçŸ¥ GUIå¼•æ“ å…¥é˜Ÿä¸€ä¸ªdiv.style.top = 200çš„å›è°ƒå‡½æ•°</span>

<span class="token comment">// åŒç†, è¿™ä¸ªé˜Ÿåˆ—ä¸­ç»´æŠ¤äº†2ä¸ªå›è°ƒ</span>
<span class="token comment">// gui queue:</span>
<span class="token comment">//    div.style.top = 200</span>
<span class="token comment">//    div.style.top = 300</span>

<span class="token comment">// åœ¨UI Renderé˜¶æ®µæ¸…ç©ºé˜Ÿåˆ—ä»»åŠ¡, ç»˜åˆ¶çº¹ç†</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="transitionåŠ¨ç”»"><a href="#transitionåŠ¨ç”»" class="header-anchor">#</a> TransitionåŠ¨ç”»</h3> <p><strong>UI Render</strong> ä¸€ä¸ªå…·ä½“çš„åº”ç”¨å°±æ˜¯<code>transition</code>åŠ¨ç”»</p> <p>ğŸŒ°</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>div<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">#div</span> <span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- æƒ³è®©è¿™ä¸ªdivåœ¨æ–‡æ¡£åŠ è½½å®Œæˆåå³200pxçš„ä½ç½®æ»šåŠ¨åˆ°300pxçš„ä½ç½® --&gt;</span>
<span class="token comment">&lt;!-- æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€äº›javascriptä»£ç  --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// example 1</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'200px'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transition <span class="token operator">=</span> <span class="token string">'top linear 1s'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'300px'</span><span class="token punctuation">;</span>

<span class="token comment">// å¦‚æœä½ æœ‰ç»éªŒçš„è¯ï¼Œä½ çŸ¥é“å®ƒä¸€å®šæ˜¯ä¸è¡Œçš„</span>

<span class="token comment">// ä½ å¯èƒ½ä¼šè¿™æ ·</span>
<span class="token comment">// example 2</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'300px'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸çŸ¥é“ä½ æ²¡æœ‰æƒ³è¿‡ä¸ºä»€ä¹ˆè¦ä¹ˆåš</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>å…¶å®è¿™ä¹Ÿå’Œ<code>Event Loop</code>æœ‰å…³</p> <p>æˆ‘ä»¬çŸ¥é“è¿‡æ¸¡åŠ¨ç”»éœ€è¦<strong>start</strong>å’Œ<strong>end</strong>2ç§çŠ¶æ€, è¿™å°±æ„å‘³ç€<strong>GUI</strong>éœ€è¦ç›¸åº”çš„åˆ¶ä½œ2ä¸ªçº¹ç†</p> <p>è€Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­</p> <ul><li><p><code>example 1</code></p> <p>ç”±äºå‘ç”Ÿäº†ä¸€æ¬¡<code>Event Loop</code>, æ‰€ä»¥æœ‰1ä¸ª<code>UI Render</code>, ç”Ÿæˆäº†1ä¸ªçº¹ç†, æ‰€ä»¥æ²¡æœ‰äº§ç”Ÿè¿‡æ¸¡</p></li> <li><p><code>example 2</code></p> <p>å‘ç”Ÿäº†2æ¬¡<code>Event Loop</code>, æœ‰2ä¸ª<code>UI Render</code>, å¹¶ä¸”2æ¬¡çš„<code>UI Render</code>é˜Ÿåˆ—éƒ½ä¸æ˜¯ç©ºçš„, æ‰€ä»¥äº§ç”Ÿäº†2ä¸ªçº¹ç†, å¯¹åº”äº†2ä¸ª<code>top</code>çŠ¶æ€, æ‰€ä»¥è¿‡æ¸¡åŠ¨ç”»ç”Ÿæ•ˆ</p></li></ul> <p>ä½ ä¹Ÿå¯ä»¥è¿™æ ·</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> port1<span class="token punctuation">,</span> port <span class="token number">2</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MessageChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
port1<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'300px'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
port2<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ä½†æ˜¯è¿™æ ·åˆ™ä¸å¯ä»¥</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'300px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å› ä¸ºè¿™æ˜¯ä¸€ä¸ªjob è€Œä¸æ˜¯ä¸€ä¸ªæ–°çš„task</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="guiå¼•æ“çš„å”¤é†’"><a href="#guiå¼•æ“çš„å”¤é†’" class="header-anchor">#</a> GUIå¼•æ“çš„å”¤é†’</h3> <p>GUIå¼•æ“çš„å”¤é†’æœ‰2ç§æ–¹å¼</p> <ul><li><p><code>UI Render</code></p> <p>å‰é¢æåˆ°è¿‡, <code>UI Render</code>é˜¶æ®µä¼šæŒ‚èµ·<code>javascript å¼•æ“</code>, å”¤é†’<code>GUIå¼•æ“</code></p></li> <li><p><code>å›æµ</code></p> <p>å‰é¢æåˆ°è¿‡, æµè§ˆå™¨å…·æœ‰<code>batch render</code>åŠŸèƒ½, ç»Ÿä¸€åœ¨<code>UI Render</code>é˜¶æ®µåˆ¶ä½œçº¹ç†</p> <p>ä½†æ˜¯åœ¨æŸäº›éœ€è¦è¯»å–å…ƒç´ ä½ç½®çš„å›æµæ“ä½œä¸Š, å¯ä»¥æ‰“ç ´ä¸Šè¿°è§„åˆ™, åœ¨é<code>UI Render</code>çš„é˜¶æ®µå”¤é†’<code>GUI å¼•æ“</code>åˆ¶ä½œçº¹ç†</p> <p>åƒå‰é¢æåˆ°çš„<code>transition</code>çš„ ğŸŒ° , ä¸ºäº†å®ç°è¿‡æ¸¡æ•ˆæœæˆ‘ä»¬è¿˜å¯ä»¥è¿™æ ·</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'200px'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transition <span class="token operator">=</span> <span class="token string">'top linear 1s'</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å”¤é†’GUIå¼•æ“, æ ¹æ®ç»´æŠ¤çš„é˜Ÿåˆ—å†…å®¹ç»˜åˆ¶çº¹ç†(top = 200)</span>

div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">'300px'</span><span class="token punctuation">;</span>
<span class="token comment">// åœ¨æœ¬æ¬¡ Event Loop çš„ UI Renderé˜¶æ®µ ç»˜åˆ¶çº¹ç†(top = 300)</span>

<span class="token comment">// è¿™ä¹Ÿæ˜¯å¯è¡Œçš„</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul> <h2 id="settimeout-setinterval-requsetanimationframeå·®å¼‚"><a href="#settimeout-setinterval-requsetanimationframeå·®å¼‚" class="header-anchor">#</a> setTimeout, setInterval, requsetAnimationFrameå·®å¼‚</h2> <h3 id="æµè§ˆå™¨æ˜¯å¦‚ä½•æ¸²æŸ“å…ƒç´ çš„"><a href="#æµè§ˆå™¨æ˜¯å¦‚ä½•æ¸²æŸ“å…ƒç´ çš„" class="header-anchor">#</a> æµè§ˆå™¨æ˜¯å¦‚ä½•æ¸²æŸ“å…ƒç´ çš„</h3> <p><a href="">TODO è¿™é‡Œæ˜¯ä¸€ä¸ªå•ç‹¬çš„å†…å®¹</a></p> <p>ç®€å•æ¥è¯´å°±æ˜¯</p> <ol><li><code>GUI å¼•æ“</code>ä¸å®šæ—¶æ ¹æ®<code>javascript å¼•æ“</code>ç»´æŠ¤çš„<code>RenderLayoutObject</code>ç»˜åˆ¶çº¹ç†</li></ol> <ul><li>è¿™é‡Œå°±æ¶‰åŠåˆ°<strong>GUI å¼•æ“çš„å”¤é†’</strong>( <code>UI Render</code>, <code>å›æµ</code>)</li></ul> <ol start="2"><li><p>å°†ç»˜åˆ¶å‡ºçš„çº¹ç†ä¼ å…¥<strong>GPU</strong></p></li> <li><p><strong>GPU</strong>ä¸å®šæ—¶å°†çº¹ç†<strong>paint</strong>åˆ°é¡µé¢ä¸Š(è¿™ä¸ªæ—¶é—´å°±æ˜¯ 1 / æµè§ˆå™¨åˆ·æ–°é¢‘ç‡)</p></li></ol> <p>å¯¹äºæŸäº›å¼€å§‹äº†<strong>GPU åŠ é€Ÿ</strong>çš„<strong>layer</strong>, åˆ™è·³è¿‡äº†<strong>CPUç»˜åˆ¶çº¹ç†çš„è¿‡ç¨‹</strong></p> <h3 id="è·³å¸§"><a href="#è·³å¸§" class="header-anchor">#</a> è·³å¸§</h3> <p>è·³å¸§æ˜¯ä¸€ç§é€»è¾‘ä¸Šçš„æ­£ç¡®, ä½†æ˜¯åœ¨UIè¡¨ç°ä¸Šæ˜¯é”™è¯¯çš„</p> <p>ğŸŒ°</p> <p>ä¸€ä¸ªäººä»¥<strong>1m/s</strong> çš„ é€Ÿåº¦è·‘äº†10s</p> <p>ä½ ä»¥<strong>1hz</strong>çš„é¢‘ç‡çœ¨çœ¼</p> <p>æ‰€ä»¥ä½ èƒ½çœ‹åˆ°çš„è¿™ä¸ªäººçš„ä½ç§»è¿‡ç¨‹æ˜¯</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1m -&gt; 2m -&gt; 3m -&gt; 4m -&gt; ... 10m
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä½†æ˜¯å¦‚æœæŸæ¬¡ä½ çªç„¶è¿·çœ¼äº†, ä½ å¯èƒ½ç”¨äº†5sæ¥æ¸…ç†ğŸ‘€ , ç­‰ä½ å†æ¬¡çœ‹è¿™ä¸ªäººçš„æ—¶å€™ä»–å¯èƒ½å·²ç»è·‘å®Œäº†</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1m -&gt; 2m -&gt; 3m -&gt; 4m -&gt; 5m -&gt; 10m
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>5m -&gt; 10m</code>çš„è¿‡ç¨‹å°±æ˜¯è·³å¸§</p> <h3 id="å¡é¡¿"><a href="#å¡é¡¿" class="header-anchor">#</a> å¡é¡¿</h3> <p>å¡é¡¿å’Œè·³å¸§ç›¸å, æ˜¯é€»è¾‘ä¸Šçš„é”™è¯¯, UIæ­£ç¡®</p> <p>è¿˜æ˜¯è¿™ä¸ªäººåœ¨ğŸƒâ€</p> <p>ä¸è¿‡å…¶é€Ÿåº¦æ˜¯ 0.00001m/s</p> <p>è¿™çœ‹èµ·æ¥å¥½åƒæ˜¯ä¸ªæ²¡å¼€å‘å®Œçš„æœºå™¨äººğŸ¤–ï¸</p> <p>è¿™è¿˜ç®—æ˜¯è·‘æ­¥ä¹ˆ?</p> <p>å¡é¡¿ä¸€èˆ¬éƒ½æ˜¯ç”±äº æ¸²æŸ“åŠ¨ç”»çš„æ—¶é—´è®¾ç½®ä¸æ­£ç¡®</p> <h3 id="setinterval"><a href="#setinterval" class="header-anchor">#</a> setInterval</h3> <p>ç”¨<code>setInterval</code>å®ç°åŠ¨ç”»æœ€å¤§çš„å¼Šç—…åœ¨äºå…¶å¾ˆå¯èƒ½ä¼šå‡ºç°è·³å¸§çš„æƒ…å†µ</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> offset <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  offset <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> offset <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>è¿™æ®µä»£ç æœŸæœ›CPU æ¯1000 / 60 ms ç»˜åˆ¶ä¸€ä¸ªçº¹ç†, ä¼ ç»™GPU</p> <p>ä½†æ˜¯å®é™…å¹¶ä¸æ€»æ˜¯å¦‚æ­¤, æ ¹æ®å‰é¢<code>Event Loop</code>çš„å†…å®¹, å‡å¦‚å‰ä¸€ä¸ª<strong>Task</strong>å‘ç”Ÿäº†5 * 1000 / 60msçš„é˜»å¡</p> <p>é‚£ä¹ˆå½“å‰<strong>macrotask queue</strong>åº”è¯¥æ˜¯è¿™æ ·çš„</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>macrotask queue:
    interval queue: 
        task 0 -&gt; offset += 10;
        task 1 -&gt; offset += 10;
        task 2 -&gt; offset += 10;
        task 3 -&gt; offset += 10;
        task 4 -&gt; offset += 10;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>è¿™ä¸ªæ—¶å€™å¯¹äº<code>task 0, task 1, task 2, task 3, task 4</code>è¿™äº›<strong>Task</strong>è€Œè¨€å°±å¤±å»äº†<code>1000 / 60</code>çš„æ—¶é—´é—´éš”</p> <p><strong>GPU</strong>ç›´æ¥åœ¨ä¸‹æ¬¡<strong>paint</strong>çš„æ—¶å€™å°†æœ€ç»ˆç»“æœ<code>offset = 60</code> ç»˜åˆ¶ åˆ° é¡µé¢ä¸Š</p> <p>å³:</p> <p><code>setInterval</code>ä¼šå‘ç”Ÿè·³å¸§</p> <h3 id="settimeout"><a href="#settimeout" class="header-anchor">#</a> setTimeout</h3> <p>ä½¿ç”¨<code>setTimeout</code>å°±ä¸ä¼šå‡ºç°è·³å¸§çš„ç°è±¡, å› ä¸º<code>setTimeout</code>å®ç°çš„åŠ¨ç”»æ˜¯åœ¨æœ€åäº§ç”Ÿäº†ä¸‹ä¸€ä¸ª<strong>Task</strong>, å³ä½¿å‰ä¸€ä¸ª<strong>Loop</strong>å‘ç”Ÿé˜»å¡, <strong>macrotask queue</strong>ä¹Ÿä¸ä¼šåƒ<code>setInterval</code>ä¸€æ ·å †ç§¯äº†å¾ˆå¤šçš„<strong>Animation Task</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> offest <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">animation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  offset <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> offset <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>animation<span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">animation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><hr> <p>çœ‹æ¥å¤šä¹ˆçš„ç¾å¥½ !!!</p> <p>ä½†æ˜¯<code>setTimout</code>è®¾ç½®çš„æ—¶é—´è¦è¶³å¤Ÿåˆé€‚</p> <p>å¤ªå¤§æˆ–è€…å¤ªå°éƒ½ä¼šæœ‰å…¶ä»–é—®é¢˜</p> <ul><li><p>æ—¶é—´é—´éš”å¾ˆå°, å¯èƒ½ä¼šæœ‰æ€§èƒ½é—®é¢˜</p> <p>æµè§ˆå™¨<strong>GPU</strong>ç»˜åˆ¶1æ¬¡, <strong>CPU</strong>ç»˜åˆ¶äº†å¤šä¸ªçº¹ç†, æˆ‘ä»¬çŸ¥é“<code>GUI</code>å’Œ<code>JS</code>æ˜¯äº’æ–¥çš„</p> <p><strong>GPU</strong>åªä½¿ç”¨åˆ°äº†æœ€åä¸€ä¸ªçº¹ç†, å…¶ä»–éƒ½è¢«æµªè´¹, <code>javascript å¼•æ“</code>è¢«æ— æ„ä¹‰çš„æŒ‚èµ·</p></li> <li><p>æ—¶é—´é—´éš”å¾ˆå¤§, å¯èƒ½ä¼šå¡é¡¿</p></li></ul> <hr> <p>æ‰€ä»¥è¿™ä¸ªæ—¶é—´é—´éš”å°½é‡å’Œ<strong>GPU</strong>æ¯æ¬¡ç»˜åˆ¶çš„æ—¶é—´é—´éš”ä¸€è‡´(æµè§ˆå™¨åˆ·æ–°é¢‘ç‡)</p> <p>ä¸€èˆ¬æµè§ˆå™¨åˆ·æ–°æ˜¯<code>60HZ</code>(å¹³å‡)</p> <p>è¿™ä¹Ÿæ˜¯æˆ‘ä»¬æ€»è®¾ç½®<code>1000 / 60</code>çš„åŸå› </p> <p>ä½†æ˜¯æ¯•ç«Ÿæµè§ˆå™¨çš„åˆ·æ–°é¢‘ç‡æ˜¯ä¸€ä¸ªåŠ¨æ€çš„å€¼, æ‰€ä»¥åé¢<code>H5</code>æå‡ºäº†<code>requestAnimationFrame</code>è¿™ä¸ªAPI</p> <h3 id="requestanimationframe"><a href="#requestanimationframe" class="header-anchor">#</a> requestAnimationFrame</h3> <p><code>requestAnimationFrame</code>æœŸæœ›å›è°ƒå‡½æ•°åœ¨æµè§ˆå™¨åˆ·æ–°<code>frame</code>å‰æ‰§è¡Œ</p> <p>ç”¨å®ƒå®ç°<code>js</code>åŠ¨ç”»å°±æ˜¯ä¸€ä¸ªåŠ¨æ€è®¾ç½®æ—¶é—´çš„<code>setTimeout</code>, å¹¶ä¸”è¿™ä¸ªæ—¶é—´æ€»æ˜¯æœ€åˆé€‚çš„</p> <p>è¿™å°±ä¿è¯äº†, åœ¨<strong>GPU</strong>ç»˜åˆ¶å‰, <strong>CPU</strong>æ€»æ˜¯è¾“å…¥ç»™<strong>GPU</strong>ä¸€ä¸ªçº¹ç†</p> <p>ä¸–ç•Œç¾å¥½äº† ï¼ï¼</p> <h2 id="node-event-loop"><a href="#node-event-loop" class="header-anchor">#</a> Node Event Loop</h2> <p>node event loop æ˜¯åŸºäº <code>libuv</code>å®ç°çš„, æŒºä¹±çš„, æš‚æ—¶æ²¡æœ‰æ•´ç†</p> <p>TODO è¿™é‡Œåº”è¯¥æ˜¯ä¸€ä¸ªé“¾æ¥</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/arkusa/askura/edit/master/docs/browser/processing_model.md" target="_blank" rel="noopener noreferrer">ç¼–è¾‘æ­¤é¡µé¢</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/20/2020, 8:37:55 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/weblog/assets/js/app.73afb69f.js" defer></script><script src="/weblog/assets/js/2.b1d48028.js" defer></script><script src="/weblog/assets/js/12.1aa44b2f.js" defer></script>
  </body>
</html>
